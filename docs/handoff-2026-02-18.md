# Handoff - 2026-02-18

## Scope Completed
- Auth + database foundation is implemented and merged to `main`.
- Credentials login is active (Auth.js + Prisma + Supabase Postgres).
- Sign-in stability fixes are in `main`, including:
  - clearer env guidance
  - hardened seed behavior
  - sign-in page no longer throws JWT decrypt noise from stale cookies

## Important Commits On `main`
- `f4eae31` - auth foundation + admin credentials login
- `d63efb4` - sign-in hardening and env/seed guidance

## Current Runtime Expectations
- Local app should run on `http://localhost:3001`.
- Required env vars live in `web/.env.local`.
- `web/.env.local` must contain valid:
  - `DATABASE_URL`
  - `DIRECT_URL`
  - `AUTH_SECRET`
  - `AUTH_URL=http://localhost:3001`
  - `ADMIN_SEED_EMAIL`
  - `ADMIN_SEED_PASSWORD`
  - `ANTHROPIC_API_KEY`

## Setup Commands (Local)
```bash
cd web
set -a
source .env.local
set +a
npm run db:seed
npm run dev -- --port 3001
```

## Known Pitfalls
- If auth errors mention JWT decrypt / secret mismatch, use a fresh incognito window or clear localhost cookies.
- If `db:seed` fails, verify `.env.local` values are valid and loaded in the current shell.
- Supabase DB passwords with special characters must be URL-encoded in DB URLs.

## Safety Rules For Env Editing
- Do not overwrite `web/.env.local` via full-file replacement commands.
- Use line-specific edits only, after explicit confirmation.
- Back up `.env.local` to `.context/` before editing.

## Suggested Next Workstream
1. Enforce strict user-scoped data access across project/thread/message queries.
2. Add production-grade account recovery/reset path (instead of any dev convenience path).
3. Add a minimal admin user management view (list users + role updates with audit logging).
